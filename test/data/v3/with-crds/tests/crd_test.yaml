suite: CRD Tests
includeCrds: true
tests:
  - it: should include CRD in rendered output
    template: crds/myresource-crd.yaml
    asserts:
      - containsDocument:
          kind: CustomResourceDefinition
          apiVersion: apiextensions.k8s.io/v1
          name: myresources.example.com

  - it: should also render deployment
    template: templates/deployment.yaml
    asserts:
      - containsDocument:
          kind: Deployment
          apiVersion: apps/v1

  - it: should validate CRD metadata
    template: crds/myresource-crd.yaml
    asserts:
      - equal:
          path: metadata.name
          value: myresources.example.com
      - equal:
          path: spec.group
          value: example.com
      - equal:
          path: spec.names.kind
          value: MyResource
